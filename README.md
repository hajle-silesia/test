## About
Provisioning Amazon GuardDuty resources by designating delegated administrator account, enabling central configuration and Splunk integration.

## Architecture
Amazon GuardDuty - Splunk integration based on [this document](amazon_guardduty_via_cloudwatch_-_talion_integration_guide_splunk.pdf).  
Amazon Data Firehose service access is granted by assuming IAM role described [here](https://docs.aws.amazon.com/firehose/latest/dev/controlling-access.html#firehose-assume-role). Remarks:
- AWS best practice is to follow policies specified in roles automatically created for services as they follow the latest security standards. This specific role reflects the role that can be generated by AWS when creating delivery stream via AWS console. See example:
![img.png](img/delivery_stream_service_access.png)
- Placeholders in automatically generated policies are the legacy of values that were meant to be removed or replaced. For the sake of changes tracking and having the latest security standards applied, it's beneficial to include them as a part of policy, as they allow for traceability when changes are made on AWS side.

## Setup
- Deploy stack that designates delegated administrator account. AWS recommendation is to use Audit account for this purpose.
- Deploy StackSet that enables Amazon GuardDuty central configuration. Use delegated administrator account ID as stack instance. It may take up to 24 hours to enable it for all accounts.
- Deploy StackSet that provisions Amazon GuardDuty - Splunk integration. Use delegated administrator account ID as stack instance.
